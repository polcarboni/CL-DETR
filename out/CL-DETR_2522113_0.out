Testing cl_detr
Running on Hostname: rezzonico
Fri Jan 31 09:47:44 2025       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.183.01             Driver Version: 535.183.01   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  Quadro RTX 5000                On  | 00000000:88:00.0 Off |                  Off |
| 33%   21C    P8               8W / 230W |      1MiB / 16384MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   1  Quadro RTX 5000                On  | 00000000:89:00.0 Off |                  Off |
| 33%   24C    P8               8W / 230W |      1MiB / 16384MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   2  Quadro RTX 5000                On  | 00000000:B1:00.0 Off |                  Off |
| 33%   25C    P8               9W / 230W |      1MiB / 16384MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   3  Quadro RTX 5000                On  | 00000000:B2:00.0 Off |                  Off |
| 33%   24C    P8              18W / 230W |      1MiB / 16384MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Active Python Environment:
tesi                  *  /homes/pcarboni/.conda/envs/tesi
Python 3.12.7
Python Path:
/homes/pcarboni/.conda/envs/tesi/bin/python
sys.path = [
    '/work/tesi_pcarboni/CL-DETR',
    '/homes/pcarboni/.conda/envs/tesi/lib/python312.zip',
    '/homes/pcarboni/.conda/envs/tesi/lib/python3.12',
    '/homes/pcarboni/.conda/envs/tesi/lib/python3.12/lib-dynload',
    '/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages',
    '/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/MultiScaleDeformableAttention-1.0-py3.12-linux-x86_64.egg',
]
USER_BASE: '/homes/pcarboni/.local' (exists)
USER_SITE: '/homes/pcarboni/.local/lib/python3.12/site-packages' (doesn't exist)
ENABLE_USER_SITE: True
running build
running build_py
running build_ext
building 'MultiScaleDeformableAttention' extension
[1/2] c++ -MMD -MF /work/tesi_pcarboni/cl_detr/models/ops/build/temp.linux-x86_64-cpython-312/work/tesi_pcarboni/cl_detr/models/ops/src/vision.o.d -pthread -B /homes/pcarboni/.conda/envs/tesi/compiler_compat -fno-strict-overflow -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /homes/pcarboni/.conda/envs/tesi/include -fPIC -O2 -isystem /homes/pcarboni/.conda/envs/tesi/include -fPIC -DWITH_CUDA -I/work/tesi_pcarboni/cl_detr/models/ops/src -I/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include -I/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/TH -I/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda-12.1/include -I/homes/pcarboni/.conda/envs/tesi/include/python3.12 -c -c /work/tesi_pcarboni/cl_detr/models/ops/src/vision.cpp -o /work/tesi_pcarboni/cl_detr/models/ops/build/temp.linux-x86_64-cpython-312/work/tesi_pcarboni/cl_detr/models/ops/src/vision.o -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=MultiScaleDeformableAttention -D_GLIBCXX_USE_CXX11_ABI=0 -std=c++17
FAILED: /work/tesi_pcarboni/cl_detr/models/ops/build/temp.linux-x86_64-cpython-312/work/tesi_pcarboni/cl_detr/models/ops/src/vision.o 
c++ -MMD -MF /work/tesi_pcarboni/cl_detr/models/ops/build/temp.linux-x86_64-cpython-312/work/tesi_pcarboni/cl_detr/models/ops/src/vision.o.d -pthread -B /homes/pcarboni/.conda/envs/tesi/compiler_compat -fno-strict-overflow -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /homes/pcarboni/.conda/envs/tesi/include -fPIC -O2 -isystem /homes/pcarboni/.conda/envs/tesi/include -fPIC -DWITH_CUDA -I/work/tesi_pcarboni/cl_detr/models/ops/src -I/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include -I/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/TH -I/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda-12.1/include -I/homes/pcarboni/.conda/envs/tesi/include/python3.12 -c -c /work/tesi_pcarboni/cl_detr/models/ops/src/vision.cpp -o /work/tesi_pcarboni/cl_detr/models/ops/build/temp.linux-x86_64-cpython-312/work/tesi_pcarboni/cl_detr/models/ops/src/vision.o -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=MultiScaleDeformableAttention -D_GLIBCXX_USE_CXX11_ABI=0 -std=c++17
In file included from /work/tesi_pcarboni/cl_detr/models/ops/src/vision.cpp:11:
/work/tesi_pcarboni/cl_detr/models/ops/src/ms_deform_attn.h: In function ‘at::Tensor ms_deform_attn_forward(const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, int)’:
/work/tesi_pcarboni/cl_detr/models/ops/src/ms_deform_attn.h:29:22: error: cannot convert ‘at::TensorBase::is_cuda’ from type ‘bool (at::TensorBase::)() const’ to type ‘bool’
   29 |     if (value.is_cuda)
      |                      ^
/work/tesi_pcarboni/cl_detr/models/ops/src/ms_deform_attn.h: In function ‘std::vector<at::Tensor> ms_deform_attn_backward(const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, int)’:
/work/tesi_pcarboni/cl_detr/models/ops/src/ms_deform_attn.h:51:22: error: cannot convert ‘at::TensorBase::is_cuda’ from type ‘bool (at::TensorBase::)() const’ to type ‘bool’
   51 |     if (value.is_cuda)
      |                      ^
[2/2] /usr/local/cuda-12.1/bin/nvcc --generate-dependencies-with-compile --dependency-output /work/tesi_pcarboni/cl_detr/models/ops/build/temp.linux-x86_64-cpython-312/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.o.d -DWITH_CUDA -I/work/tesi_pcarboni/cl_detr/models/ops/src -I/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include -I/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -I/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/TH -I/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/THC -I/usr/local/cuda-12.1/include -I/homes/pcarboni/.conda/envs/tesi/include/python3.12 -c -c /work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu -o /work/tesi_pcarboni/cl_detr/models/ops/build/temp.linux-x86_64-cpython-312/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -DCUDA_HAS_FP16=1 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=MultiScaleDeformableAttention -D_GLIBCXX_USE_CXX11_ABI=0 -gencode=arch=compute_75,code=compute_75 -gencode=arch=compute_75,code=sm_75 -std=c++17
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_im2col_cuda.cuh(261): warning #177-D: variable "q_col" was declared but never referenced
      const int q_col = _temp % num_query;
                ^
          detected during instantiation of "void ms_deformable_im2col_cuda(cudaStream_t, const scalar_t *, const int64_t *, const int64_t *, const scalar_t *, const scalar_t *, int, int, int, int, int, int, int, scalar_t *) [with scalar_t=double]" at line 64 of /work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_im2col_cuda.cuh(762): warning #177-D: variable "q_col" was declared but never referenced
      const int q_col = _temp % num_query;
                ^
          detected during instantiation of "void ms_deformable_col2im_cuda(cudaStream_t, const scalar_t *, const scalar_t *, const int64_t *, const int64_t *, const scalar_t *, const scalar_t *, int, int, int, int, int, int, int, scalar_t *, scalar_t *, scalar_t *) [with scalar_t=double]" at line 134 of /work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu

/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_im2col_cuda.cuh(872): warning #177-D: variable "q_col" was declared but never referenced
      const int q_col = _temp % num_query;
                ^
          detected during instantiation of "void ms_deformable_col2im_cuda(cudaStream_t, const scalar_t *, const scalar_t *, const int64_t *, const int64_t *, const scalar_t *, const scalar_t *, int, int, int, int, int, int, int, scalar_t *, scalar_t *, scalar_t *) [with scalar_t=double]" at line 134 of /work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu

/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_im2col_cuda.cuh(331): warning #177-D: variable "q_col" was declared but never referenced
      const int q_col = _temp % num_query;
                ^
          detected during instantiation of "void ms_deformable_col2im_cuda(cudaStream_t, const scalar_t *, const scalar_t *, const int64_t *, const int64_t *, const scalar_t *, const scalar_t *, int, int, int, int, int, int, int, scalar_t *, scalar_t *, scalar_t *) [with scalar_t=double]" at line 134 of /work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu

/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_im2col_cuda.cuh(436): warning #177-D: variable "q_col" was declared but never referenced
      const int q_col = _temp % num_query;
                ^
          detected during instantiation of "void ms_deformable_col2im_cuda(cudaStream_t, const scalar_t *, const scalar_t *, const int64_t *, const int64_t *, const scalar_t *, const scalar_t *, int, int, int, int, int, int, int, scalar_t *, scalar_t *, scalar_t *) [with scalar_t=double]" at line 134 of /work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu

/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_im2col_cuda.cuh(544): warning #177-D: variable "q_col" was declared but never referenced
      const int q_col = _temp % num_query;
                ^
          detected during instantiation of "void ms_deformable_col2im_cuda(cudaStream_t, const scalar_t *, const scalar_t *, const int64_t *, const int64_t *, const scalar_t *, const scalar_t *, int, int, int, int, int, int, int, scalar_t *, scalar_t *, scalar_t *) [with scalar_t=double]" at line 134 of /work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu

/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_im2col_cuda.cuh(649): warning #177-D: variable "q_col" was declared but never referenced
      const int q_col = _temp % num_query;
                ^
          detected during instantiation of "void ms_deformable_col2im_cuda(cudaStream_t, const scalar_t *, const scalar_t *, const int64_t *, const int64_t *, const scalar_t *, const scalar_t *, int, int, int, int, int, int, int, scalar_t *, scalar_t *, scalar_t *) [with scalar_t=double]" at line 134 of /work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu

/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu: In function ‘at::Tensor ms_deform_attn_cuda_forward(const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, int)’:
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:34:61: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
   34 |     AT_ASSERTM(value.type().is_cuda(), "value must be a CUDA tensor");
      |                                                   ~~~~~~~~~~^~
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
  225 |   DeprecatedTypeProperties & type() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:35:70: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
   35 |     AT_ASSERTM(spatial_shapes.type().is_cuda(), "spatial_shapes must be a CUDA tensor");
      |                                                   ~~~~~~~~~~~~~~~~~~~^~
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
  225 |   DeprecatedTypeProperties & type() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:36:73: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
   36 |     AT_ASSERTM(level_start_index.type().is_cuda(), "level_start_index must be a CUDA tensor");
      |                                                   ~~~~~~~~~~~~~~~~~~~~~~^~
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
  225 |   DeprecatedTypeProperties & type() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:37:68: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
   37 |     AT_ASSERTM(sampling_loc.type().is_cuda(), "sampling_loc must be a CUDA tensor");
      |                                                   ~~~~~~~~~~~~~~~~~^~
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
  225 |   DeprecatedTypeProperties & type() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:38:67: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
   38 |     AT_ASSERTM(attn_weight.type().is_cuda(), "attn_weight must be a CUDA tensor");
      |                                                   ~~~~~~~~~~~~~~~~^~
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
  225 |   DeprecatedTypeProperties & type() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu: In lambda function:
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:64:42: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
   64 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
      |                              ~~~~~~~~~~~~^~
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
  225 |   DeprecatedTypeProperties & type() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:64:163: warning: ‘c10::ScalarType detail::scalar_type(const at::DeprecatedTypeProperties&)’ is deprecated: passing at::DeprecatedTypeProperties to an AT_DISPATCH macro is deprecated, pass an at::ScalarType instead [-Wdeprecated-declarations]
   64 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
      |                                                                                                                                                                   ^         
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/Dispatch.h:109:1: note: declared here
  109 | inline at::ScalarType scalar_type(const at::DeprecatedTypeProperties& t) {
      | ^~~~~~~~~~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu: In lambda function:
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:64:1049: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
   64 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:64:1135: warning: ‘T* at::Tensor::data() const [with T = long int]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
   64 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:64:1178: warning: ‘T* at::Tensor::data() const [with T = long int]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
   64 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:64:1211: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
   64 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:64:1294: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
   64 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:64:1452: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
   64 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu: In lambda function:
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:64:2318: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
   64 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:64:2404: warning: ‘T* at::Tensor::data() const [with T = long int]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
   64 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:64:2447: warning: ‘T* at::Tensor::data() const [with T = long int]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
   64 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:64:2479: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
   64 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:64:2561: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
   64 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:64:2718: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
   64 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_forward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu: In function ‘std::vector<at::Tensor> ms_deform_attn_cuda_backward(const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, int)’:
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:100:61: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
  100 |     AT_ASSERTM(value.type().is_cuda(), "value must be a CUDA tensor");
      |                                                   ~~~~~~~~~~^~
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
  225 |   DeprecatedTypeProperties & type() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:101:70: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
  101 |     AT_ASSERTM(spatial_shapes.type().is_cuda(), "spatial_shapes must be a CUDA tensor");
      |                                                   ~~~~~~~~~~~~~~~~~~~^~
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
  225 |   DeprecatedTypeProperties & type() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:102:73: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
  102 |     AT_ASSERTM(level_start_index.type().is_cuda(), "level_start_index must be a CUDA tensor");
      |                                                   ~~~~~~~~~~~~~~~~~~~~~~^~
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
  225 |   DeprecatedTypeProperties & type() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:103:68: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
  103 |     AT_ASSERTM(sampling_loc.type().is_cuda(), "sampling_loc must be a CUDA tensor");
      |                                                   ~~~~~~~~~~~~~~~~~^~
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
  225 |   DeprecatedTypeProperties & type() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:104:67: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
  104 |     AT_ASSERTM(attn_weight.type().is_cuda(), "attn_weight must be a CUDA tensor");
      |                                                   ~~~~~~~~~~~~~~~~^~
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
  225 |   DeprecatedTypeProperties & type() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:105:67: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
  105 |     AT_ASSERTM(grad_output.type().is_cuda(), "grad_output must be a CUDA tensor");
      |                                                   ~~~~~~~~~~~~~~~~^~
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
  225 |   DeprecatedTypeProperties & type() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu: In lambda function:
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:42: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                              ~~~~~~~~~~~~^~
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
  225 |   DeprecatedTypeProperties & type() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:164: warning: ‘c10::ScalarType detail::scalar_type(const at::DeprecatedTypeProperties&)’ is deprecated: passing at::DeprecatedTypeProperties to an AT_DISPATCH macro is deprecated, pass an at::ScalarType instead [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                    ^         
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/Dispatch.h:109:1: note: declared here
  109 | inline at::ScalarType scalar_type(const at::DeprecatedTypeProperties& t) {
      | ^~~~~~~~~~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu: In lambda function:
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:1059: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:1085: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:1171: warning: ‘T* at::Tensor::data() const [with T = long int]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:1214: warning: ‘T* at::Tensor::data() const [with T = long int]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:1247: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:1330: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:1491: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:1575: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:1663: warning: ‘T* at::Tensor::data() const [with T = double]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu: In lambda function:
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:2590: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:2615: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:2701: warning: ‘T* at::Tensor::data() const [with T = long int]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:2744: warning: ‘T* at::Tensor::data() const [with T = long int]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:2776: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:2858: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:3018: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:3101: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
/work/tesi_pcarboni/cl_detr/models/ops/src/cuda/ms_deform_attn_cuda.cu:134:3188: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
  134 |         AT_DISPATCH_FLOATING_TYPES(value.type(), "ms_deform_attn_backward_cuda", ([&] {
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^ 
/homes/pcarboni/.conda/envs/tesi/lib/python3.12/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
  247 |   T * data() const {
      | ^ ~~
ninja: build stopped: subcommand failed.
| distributed init (rank 0): env://
| distributed init (rank 1): env://
